\documentclass{article} %[twocolumn]
% محمود امین‌طوسی، http://webpages.iust.ac.ir/mamintoosi
\usepackage[nonamebreak,square,super]{natbib}%nonamebreak,numbers,
\usepackage[colorlinks,citecolor=blue]{hyperref} %,pagebackref=true
%\usepackage[top=25mm, bottom=25mm, left=80mm, right=80mm]{geometry}
\usepackage{verbatim}



%\usepackage{chicago}


\usepackage[Kashida]{xepersian}%
\settextfont[Scale=1]{Yas}
\setlatintextfont[Scale=1]{Times New Roman}%{Linux Libertine}

%\usepackage{mybib}


\title{چگونه مراجع لاتین را با قالب نویسنده-سال و با نام نویسندگان فارسی داشته باشیم؟}
\author{محمود امین‌طوسی}%\date{}


\begin{document}
\maketitle
\section{مقدمه}
معمولاً در مستندات فارسی خواسته می‌شود که نام‌های لاتین مؤلفین در متن به صورت فارسی نوشته شود ولی در لیست مراجع به صورت انگلیسی ظاهر شوند. اگر از استیلهای \lr{plainnat} یا \lr{chicago} در مستندات زی‌پرشین استفاده کنیم با مشکلاتی مواجه هستیم. 
با استفاده از استیل‌های جدید \lr{plainnat-fa.bst}، \lr{asa-fa.bst}  و \lr{chicago-fa.bst} می‌توانید در زمانیکه متن شما فارسی و مراجعتان لاتین است از قالب مراجع به صورت «نویسنده-سال» استفاده کنید. به این منظور باید در هر مدخل مراجع خود یک فیلد جدید به نام \lr{authorfa} تعریف نموده و معادل فارسی نام مؤلفین را در آن قید کنید. همچنین به خاطر رفع مشکل مرتب‌سازی حروف گچپژ و کاف فارسی، فایلی با نام \lr{`cp1256fa.csf'} آماده شده است که باید آنرا به همراه \lr{bibtex8} بکار ببرید.
دنباله عملیات لازم برای تولید خروجی در ضمیمه آمده است.

تا آنجا که بررسی شده است، استیل آماده شده با فرامین معمول بستهٔ \lr{natbib} که در راهنمای آن آمده است (مانند \lr{cite,citet,citep}) به خوبی کار می‌کند. در ادامه مثالهای متنوعی از انواع مختلف مراجع و برخی دستورات ارجاع‌دهی در \lr{natbib} آمده است. دقت داشته باشید که  برای استفاده از فایل‌های استیل فارسی فوق‌الذکر باید بستهٔ \lr{natbib} نصب شده و آنرا فراخوانی نموده باشید. در این بسته به صورت پیش‌فرض در ارجاع به مراجع، از پرانتز استفاده می‌شود، لیکن از آنجا که در این سند این بسته با ذکر \lr{[square]} فراخوانی شده است، مراجع با کروشه مشخص شده‌اند. 
\section{مثالها}

\citet{Borman04thesis} در پایان‌نامهٔ دکترای خود به موضوع وضوح برتر پرداخته است.

\citet{Amintoosi09precise} یک روش افزایش وضوح تصویر ارائه دادند. این روش توسط \citet{Amintoosi09video} برای ویدئو بکار گرفته شد.همانگونه که می‌بینید در این مرجع که دو مؤلف داریم فامیل هر دو آمده است. ضمناً هر دو مرجع لاتین هستند که در فیلد \lr{authorfa} معادل فارسی آنها ذکر شده بوده است.

خوب حالا ببینیم با مرجع \citep{Amintoosi09regional} چکار می‌کند. از آنجا که مؤلفین این مقاله و مقاله اول و سال نشر هر دو یکی است در کنار سال، \lr{a,b,c,...} قرار می‌گیرد. این یکی را تبدیل به الف و ب نمی‌کنیم چرا که در لیست مراجع به همین صورت ظاهر می‌شوند.

و حالا چند مرجع از انواع مختلف  را با هم ببینیم:  \citet{Omidali82phdThesis} یک نمونه پروژه دکترا، مرجع \citet[فصل ۲]{Pourmousa88mscThesis} یک نمونه پروژه کارشناسی ارشد فارسی که به فصل دوم آن ارجاع داده شده و  مرجع \citep{Abadi87} یک نمونه مقاله مجله فارسی است که با \lr{citep} به آن ارجاع داده شده و لذا کلاً داخل کروشه قرار گرفته است.
 مرجع \citet[همچنین ببینید][بخش ۲]{Amintoosi87afzayesh}  یک نمونه  مقاله کنفرانس فارسی با ذکر «همچنان ببینید و بخش خاص» و مرجع \cite{Pedram80osool} یک نمونه کتاب فارسی با ذکر مترجمان و ویراستاران فارسی است. مرجع \cite{Khalighi07MscThesis}
 یک نمونه پروژه کارشناسی ارشد انگلیسی و \citealp*{Khalighi87xepersian} هم یک نمونه متفرقه  می‌باشند 
که از آنجا که از \lr{citealp*}  استفاده شده نام تمام مؤلفین نشان داده شده است، برخلاف موارد قبلی که مؤلفین سوم به بعد با «ودیگران» جایگزین می‌شد. البته در حال حاضر این مورد فقط برای مراجع فارسی بدرستی عمل می‌نماید. \citet{Gonzalez02book} یک کتاب لاتین است.

همانگونه که دیده می‌شود، مراجع فارسی و لاتین هم در متن و هم در لیست مراجع به صورت درست نمایش داده شده اند. 

یک نکته جالب آنکه اگر اسامی مؤلفان چند مرجع یکسان باشد (فارسی یا معادل فارسی آنها) و  به آنها  پشت سرهم ارجاع دهیم، اسامی فقط یک بار ظاهر خواهند شد. مثلاً \citet{Amintoosi09precise,Amintoosi87afzayesh} دو مقاله از نویسندگان یکسان ولی اولی به لاتین و دومی به فارسی است که سال نشر آنها مؤید این مطلب است. 
 البته یک نقطه ضعف کوچک هم دارد و آن این است که برای تست یکسان بودن مراجع همین برچسب مورد عمل قرار می‌گیرد. به عنوان مثال از آنجا که برای هر دو مقاله «امین‌طوسی و دیگران» آمده است* بدون توجه به اینکه سایر همکاران ممکن است متفاوت باشند در یک دسته قرار می‌گیرند.

مثالی از کنفرانس بدون نویسنده:  \citep{conference06}





\section{محدودیت‌ها}
\begin{itemize}
\item همانگونه که مشاهده می‌کنید با بستهٔ \lr{hyperref} مشکلی وجود ندارد، البته به شرط داشتن بستهٔ \lr{bidi}نسخهٔ ۱.۰.۴ (\lr{revision} ۱۹۰ به بعد) . فقط یک استثناءوجود دارد و آن هم رنگ مرجع در هنگامی است که  قسمتی از اسامی مؤلفین یک مرجع درانتهای یک خط و قسمتی دیگر در ابتدای خط بعد قرار گیرد. در این حالت کل دو خط رنگی می‌شوند. اما راه حلی برای آن با  گزینه \lr{nonamebreak}  از بستهٔ \lr{natbib} و گزینه  کشیده \lr{(Kashida)} از بستهٔ زی‌پرشین وجود دارد.

یک مثال را ببینیم:

در اینجا  چند مرجع پشت سر هم  داریم که از یک خط بیشتر شده‌اند : \citet{Omidali82phdThesis}  و  \citealp*{Khalighi87xepersian} و \citet{Amintoosi09precise,Amintoosi87afzayesh}  
اگر گزینه  \lr{nonamebreak} را استفاده نکنید هر دو خط آبی خواهند شد. با استفاده از گزینهٔ مذکور  که مربوط به بستهٔ \lr{natbib} است، این مشکل رنگی شدن دو خط برطرف می‌شود ولی ممکن است تنظیم خط به هم بخورد،‌ کمتر از طول خط شود و یا از حد خارج شود. این مشکل بسیاری از اوقات توسط گزینهٔ کشیده \lr{(Kashida)}  در بستهٔ زی‌پرشین قابل حل است.

\item متاسفانه \lr{bibtex} قادر به جداسازی حرف اول نامهای فارسی نیست، لذا در استیل‌‌هایی که حرف اول نامهای لاتین ظاهر می‌شوند، نامهای فارسی به صورت کامل نشان داده می‌شوند. اگر نیاز به این حالت دارید، باید به صورت دستی نامها در مراجع فارسی را اصلاح نمایید.
\end{itemize}

%\section{چند نکته}
{\bf چند نکته:}
\begin{enumerate}
\item مراجع فارسی نیازی به فیلد \lr{authorfa} ندارند.
\item دقت داشته باشید که اگر اول فامیل و سپس اسم را می‌نویسید، اسم و فامیل را با کامای انگلیسی از هم جدا کنید. اگر حروف اول اسم را مونویسید، پس از آن نقطه و بعد حتماً یک فاصله و سپس فامیل را بنویسید.
\item رمزینه فایل \lr{.bib} شما باید یونیکد یا \lr{UTF-8} باشد، در غیراینصورت (مثلاً اگر \lr{UTF-8 without BOM}  باشد) در لینوکس با مشکل مواجه خواهید شد.
\item اگر مایلید که همچون این مثال، خط دوم هر مرجع کمی جلوتر برده شود فایل \lr{mybib.sty} را با دستور \lr{usepackage} پس از زی‌پرشین فراخوانی نمایید.
\item در مرجع \cite{Baker02limits}،  فیلد \lr{authorfa} را نداریم، اسامی به صورت لاتین و برعکس نوشته شده‌اند و سال هم به فارسی نوشته شده است. اگر آنرا به صورت لاتین می‌خواهید دستور ارجاع را به صورت \LRE{\verb+\LRE{\lr{\cite{referenceTag}}}+} بکار ببرید.

 حالا مرجع \LRE{\lr{\cite{Baker02limits}}} درست نمایش داده می‌شود. البته می‌توانید یک دستور جدید مثلاً به صورت زیر تعریف نمایید:
\begin{latin}
\begin{verbatim}
\newcommand\LRcite[1]{\LRE{\lr{\cite{#1}}}}
\end{verbatim}
\end{latin}

\end{enumerate}
% \setlength{\bibhang}{5.3em}%\bibhang=1in
\bibliographystyle{asa-fa}%{chicago-fa}%{plainnat-fa}%
%\begin{latin}
\bibliography{SomeReferences}
%\end{latin}
\appendix
\section{چگونه با فایلهای \lr{.bst} فارسی کار کنیم؟}
فرض کنید نام فایل شما \lr{`myfile.tex'} و نام فایل حاوی مراجع شما \lr{ `SomeReferences.bib'} باشد. این فایل و فایل \lr{`cp1256fa.csf'} باید در همان شاخه فایل اصلی شما یا در مسیر سیستم باشند. برای آشنایی با ساختار فایل \lr{`SomeReferences.bib'} به همین فایل که همراه این مثال است مراجعه قرمایید. دنباله کارهای زیر را برای حصول به نتیجه باید انجام دهید:
\begin{latin}
\begin{enumerate}
\item xelatex myfile
\item bibtex8 -W -c cp1256fa myfile
\item xelatex myfile
\item xelatex myfile
\end{enumerate}
\end{latin}
می‌توانید به جای \lr{bibtex8} از {\lr{bibtex}}  و بدون هیچ گزینهٔ اضافه‌ای استفاده کنید ولی در این حالت مراجع فارسی شما مرتب نخواهند بود، مگر آنکه از {noopsort} استفاده کنید.


\end{document}